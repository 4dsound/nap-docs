<!-- HTML header for doxygen 1.8.13-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<link rel="shortcut icon" href="../../content/icon.ico" type="image/x-icon" />
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>NAP: Getting Started</title>
<link href="https://fonts.googleapis.com/css?family=Montserrat" rel="stylesheet">
<link href="https://fonts.googleapis.com/css?family=Nunito+Sans" rel="stylesheet">
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<script type="text/javascript">
  function inlineSVGfromIFrame () {
    console.log("blaaat")
    var alreadyImported = Boolean(document.querySelectorAll('.dyncontent svg').length)
    if (alreadyImported) return
    var allIFrames = document.querySelectorAll('.dyncontent iframe')
    var allContentBoxes = document.querySelectorAll('.dyncontent .center')
    allIFrames.forEach(function(iFrame, index) {
      var svgElem = iFrame.contentWindow.document.documentElement.cloneNode(true)
      allContentBoxes[index].appendChild(svgElem)
      iFrame.style.display = 'none'
    })
  }
  window.addEventListener("load", inlineSVGfromIFrame, false)
</script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><a href="https://nap.tech"><img alt="Logo" src="../../nap_tech_logo.svg"/></a></td>
  <td id="projectalign" style="padding-left: 0.5em;"><a href="http://www.napframework.com">
   <div id="projectname">NAP
   </div>
  </a>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Getting Started </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><ul>
<li><a class="el" href="../../d1/d66/getting_started.html#getting_started_overview">Overview</a></li>
<li><a class="el" href="../../d1/d66/getting_started.html#create_blank_app">Create a New Project</a></li>
<li><a class="el" href="../../d1/d66/getting_started.html#add_module">Add a Module</a></li>
<li><a class="el" href="../../d1/d66/getting_started.html#compile_run">Compile and Run</a></li>
<li><a class="el" href="../../d1/d66/getting_started.html#add_content">Add Content</a><ul>
<li><a class="el" href="../../d1/d66/getting_started.html#audio_resource">Resource</a></li>
<li><a class="el" href="../../d1/d66/getting_started.html#audio_entity">Entity</a></li>
<li><a class="el" href="../../d1/d66/getting_started.html#audio_components">Component</a></li>
<li><a class="el" href="../../d1/d66/getting_started.html#content_scene">Scene</a></li>
</ul>
</li>
<li><a class="el" href="../../d1/d66/getting_started.html#app_logic">Add Logic</a><ul>
<li><a class="el" href="../../d1/d66/getting_started.html#app_init">Init</a></li>
<li><a class="el" href="../../d1/d66/getting_started.html#app_update">Update</a></li>
<li><a class="el" href="../../d1/d66/getting_started.html#app_render">Render</a></li>
</ul>
</li>
<li><a class="el" href="../../d1/d66/getting_started.html#app_package">Package for Distribution</a></li>
</ul>
<h1><a class="anchor" id="getting_started_overview"></a>
Overview</h1>
<p>In this tutorial we're going to make a new application that plays an audio file from disk. You can start / stop playback using a button that is rendered to screen. This tutorial assumes you are working from a pre-compiled NAP package, not the NAP source-code.</p>
<h1><a class="anchor" id="create_blank_app"></a>
Create a New Project</h1>
<p>To create a new project:</p>
<ul>
<li>Use a terminal to navigate to the <code>tools</code> directory, inside the NAP installation root.</li>
<li>Run <code>create_project.bat NewProject</code> (Windows) or <code>./create_project NewProject</code> (macOS and Linux)</li>
</ul>
<p>After creation your new project is located at <code>projects/newproject</code>. This directory contains the application source-code, scenes, assets and build instructions. The <code>project.json</code> file, in the root of the directory, defines how your application is called and which modules it requires:</p>
<div class="fragment"><div class="line">{</div>
<div class="line">    &quot;Type&quot;: &quot;nap::ProjectInfo&quot;,</div>
<div class="line">    &quot;mID&quot;: &quot;ProjectInfo&quot;,</div>
<div class="line">    &quot;Title&quot;: &quot;NewProject&quot;,</div>
<div class="line">    &quot;Version&quot;: &quot;0.1.0&quot;,</div>
<div class="line">    &quot;RequiredModules&quot;: [</div>
<div class="line">        &quot;mod_napapp&quot;,</div>
<div class="line">        &quot;mod_napcameracontrol&quot;,</div>
<div class="line">        &quot;mod_napparametergui&quot;,</div>
<div class="line">        &quot;mod_newproject&quot;</div>
<div class="line">    ],</div>
<div class="line">    &quot;Data&quot;: &quot;data/objects.json&quot;,</div>
<div class="line">    &quot;ServiceConfig&quot;: &quot;&quot;,</div>
<div class="line">    &quot;PathMapping&quot;: &quot;cache/path_mapping.json&quot;</div>
<div class="line">}</div>
</div><!-- fragment --><h1><a class="anchor" id="add_module"></a>
Add a Module</h1>
<p>The <code>RequiredModules</code> field tells the build system which modules to include for your project. The most important module is <code>mod_newproject</code>. This is your custom application module, located inside the <code>module</code> directory of your project. By default this module links to <code>mod_naprender</code>, <code>mod_napscene</code> and <code>mod_napparameter</code>. This means your application (and application module) can use of all the building blocks exposed by those modules. What's missing here is audio functionality. We can link in audio by adding <code>mod_napaudio</code> to the list of <code>RequiredModules</code> of the application module.</p>
<p>Open <code>module.json</code> inside the <code>module</code> directory and add <code>mod_napaudio</code> to <code>RequiredModules</code>:</p>
<div class="fragment"><div class="line">{</div>
<div class="line">    &quot;Type&quot;: &quot;nap::ModuleInfo&quot;, </div>
<div class="line">    &quot;mID&quot;: &quot;ModuleInfo&quot;, </div>
<div class="line">    &quot;RequiredModules&quot;: [</div>
<div class="line">        &quot;mod_naprender&quot;,</div>
<div class="line">        &quot;mod_napscene&quot;,</div>
<div class="line">        &quot;mod_napparameter&quot;,</div>
<div class="line">        &quot;mod_napaudio&quot;</div>
<div class="line">    ], </div>
<div class="line">    &quot;WindowsDllSearchPaths&quot;: []</div>
<div class="line">}</div>
</div><!-- fragment --><p>If you add <code>mod_napaudio</code> as a <code>RequiredModule</code> to your application, instead of your application module, you won't have access to the audio resources in your own module. It is therefore recommended to always link to other modules from your application module and not the application directly.</p>
<h1><a class="anchor" id="compile_run"></a>
Compile and Run</h1>
<p>After changing the <code>module.json</code> file you need to (re)generate the project by executing the <code>regenerate</code> shortcut in the project folder. You can build and run the project using Visual Studio on Windows (in directory <code>msvc64</code>), Xcode on macOS (in <code>xcode</code>) or make on Linux (in <code>build</code>).</p>
<p>Open the generated solution and select the <code>Release</code> configuration. Compile and run your application. You should see an empty window pop up. To learn more about setting up projects, modules and third-party dependencies read the <a class="el" href="../../d9/d68/project_management.html">Project Management</a> documentation.</p>
<h1><a class="anchor" id="add_content"></a>
Add Content</h1>
<p>The <code>data</code> folder within your project folder contains an <code>objects.json</code> file. This file describes the general structure of your application and all additional resources that are required. Objects in this file can be split up into three different categories:</p>
<ul>
<li><a class="el" href="../../d9/d3b/resources.html">Resources</a>: static, often read-only data such as an image, window, 3D mesh etc.</li>
<li><a class="el" href="../../d0/d9b/scene.html">Entities</a>: groups functionality by combining a set of components.</li>
<li><a class="el" href="../../d0/d9b/scene.html">Components</a>: adds specfic logic to an entity, receives an update call every frame.</li>
</ul>
<h2><a class="anchor" id="audio_resource"></a>
Resource</h2>
<p>Let's add an <a class="el" href="../../d1/d65/classnap_1_1audio_1_1_audio_file_resource.html">audio file</a> resource. Instead of editing JSON files by hand we're going to use <a class="el" href="../../da/d34/napkin.html">Napkin</a>:</p>
<ul>
<li>Go to the <code>tools/napkin</code> directory</li>
<li>Launch the <code>napkin</code> executable</li>
<li>Click on <code>File</code> -&gt; <code>Open Project</code></li>
<li>Select the <code>project.json</code> file</li>
</ul>
<p>Result:</p>
<div class="image">
<img src="../../content/gs_napkin.png" alt=""/>
</div>
   <p>If Napkin fails to load the project make sure to <a class="el" href="../../d1/d66/getting_started.html#compile_run">build</a> the project (in <code>Release</code> mode) at least once before loading it. This ensures that the custom application module <code>mod_newproject</code> is compiled for you. The editor can then load and inspect it. All other modules (render, audio etc.) are pre-compiled and should work out of the box.</p>
<p>To add an audio file:</p>
<ul>
<li>Right click on the <code>Resources</code> item inside the resource panel</li>
<li>Select <code>Create Resource</code></li>
</ul>
<div class="image">
<img src="../../content/gs_napkin_create_resource.png" alt=""/>
</div>
   <ul>
<li>Select a <code><a class="el" href="../../d1/d65/classnap_1_1audio_1_1_audio_file_resource.html">nap::audio::AudioFileResource</a></code></li>
<li>Double click on the new resource</li>
<li>Change the name to <code>AudioFile</code></li>
</ul>
<p>If we save and start the application right now it will fail to initialize because the resource doesn't point to a valid file on disk:</p>
<ul>
<li>Select the <code>AudioFile</code> resource</li>
<li>Inside the inspector panel: click on the <code>folder</code> icon next to <code>AudioFilePath</code></li>
<li>Browse to the file you want to load</li>
</ul>
<p>The audio file should be sourced from the <code>data</code> directory of your project. This allows the application to use relative paths, instead of absolute. Don't have a file on disk? Copy one from the <code>audioplaybackdemo</code>.</p>
<div class="image">
<img src="../../content/gs_audio_file.png" alt=""/>
</div>
   <h2><a class="anchor" id="audio_entity"></a>
Entity</h2>
<p>Continue by adding an entity that will hold the audio components.</p>
<ul>
<li>Right click on the <code>Entities</code> item in the resource panel.</li>
<li>Select <code>Create Entity</code>.</li>
</ul>
<div class="image">
<img src="../../content/gs_napkin_create_entity.png" alt=""/>
</div>
   <ul>
<li>Double click on the new entity and change its name to <code>AudioEntity</code>.</li>
</ul>
<h2><a class="anchor" id="audio_components"></a>
Components</h2>
<p>The <code>AudioEntity</code> requires 2 components: an <a class="el" href="../../d3/d49/classnap_1_1audio_1_1_playback_component.html">AudioPlaybackComponent</a> to play back the audio file and an <a class="el" href="../../df/d82/classnap_1_1audio_1_1_output_component.html">OutputComponent</a> to route the output of the playback component to the audio device.</p>
<ul>
<li>Right click on the <code>AudioEntity</code></li>
<li>Select <code>Add Component</code> from the popup menu</li>
</ul>
<div class="image">
<img src="../../content/gs_napkin_add_component.png" alt=""/>
</div>
   <ul>
<li>Select a <a class="el" href="../../d3/d49/classnap_1_1audio_1_1_playback_component.html">nap::audio::PlaybackComponent</a></li>
<li>Rename it to <code>PlaybackComponent</code></li>
</ul>
<p>Do the same for the <a class="el" href="../../df/d82/classnap_1_1audio_1_1_output_component.html">nap::audio::OutputComponent</a>, rename it to <code>OutputComponent</code>. But we're not there yet: we need to tell the audio playback component which file to play and how many audio channels it outputs:</p>
<ul>
<li>Select the <code>PlaybackComponent</code></li>
<li>Click on the <code>arrow</code> icon next to <code>Buffer</code></li>
<li>Select the <code>AudioFile</code></li>
</ul>
<div class="image">
<img src="../../content/gs_napkin_audio_playback.png" alt=""/>
</div>
   <p>Next we instruct the output component how to route the stereo output of the playback component to the audio device.</p>
<ul>
<li>Select the <code>OutputComponent</code></li>
<li>Click on the <code>arrow</code> icon next to <code>Input</code></li>
<li>Select the <code>PlaybackComponent</code></li>
</ul>
<div class="image">
<img src="../../content/gs_napkin_audio_output.png" alt=""/>
</div>
   <h2><a class="anchor" id="content_scene"></a>
Scene</h2>
<p>To make sure the audio entity is created on startup we have to add it to the scene.</p>
<ul>
<li>Right click on the <code>Scene</code> item inside the scene panel</li>
<li>Select <code>Add Entity</code>.</li>
</ul>
<div class="image">
<img src="../../content/gs_napkin_add_entity.png" alt=""/>
</div>
   <ul>
<li>Select the <code>AudioEntity</code></li>
<li>Save the file (<code>File</code> -&gt; <code>Save</code>)</li>
<li>Run the app from your IDE</li>
</ul>
<p>You should see a blank window and hear the audio file played back on the default audio device. If you don't hear anything make sure to save the file. Otherwise check the log.</p>
<h1><a class="anchor" id="app_logic"></a>
Application</h1>
<p>Close Napkin and open the <code>newprojectapp.h</code> file located inside the <code>src</code> directory. This document, together with the <code>.cpp</code> file, contains the application runtime code. It allows you to control the flow of data and render specific objects to screen using the resources we just created.</p>
<h2><a class="anchor" id="app_init"></a>
Init</h2>
<p>The init method is used to initialize important parts of your application and store references to resources. For this example we need access to the <code>AudioEntity</code>. Add the following line of code to your application class declaration, right after <code>mGnomonEntity</code> in <code>newprojectapp.h</code>:</p>
<div class="fragment"><div class="line">ObjectPtr&lt;EntityInstance&gt;   mAudioEntity = <span class="keyword">nullptr</span>;         <span class="comment">///&lt; Pointer to the entity that plays back music</span></div>
</div><!-- fragment --><p>And add the following line of code to the end of the <code>NewProjectApp::init()</code> method of your application in <code>newprojectapp.cpp</code>:</p>
<div class="fragment"><div class="line">mAudioEntity = mScene-&gt;findEntity(<span class="stringliteral">&quot;AudioEntity&quot;</span>);</div>
</div><!-- fragment --><p>We just created a link to the audio entity. We can use this link to manipulate the entity and it's components when the app is running.</p>
<h2><a class="anchor" id="app_update"></a>
Update</h2>
<p>The <code>update</code> method is called every frame. The parameter <code>deltaTime</code> indicates how many seconds have passed since the last update call. You should perform any app specific logic in here that does not concern rendering.</p>
<p>Because we set the property <code>AutoPlay</code> of the PlaybackComponent in the app structure file to <code>True</code>, the file starts playing automatically on startup. Let's add a button to start and stop playback at runtime. Add the following include directives to <code>newprojectapp.cpp</code>:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;audio/component/playbackcomponent.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;imgui/imgui.h&gt;</span></div>
</div><!-- fragment --><p>.. and add the following block of code to the <code>update</code> method:</p>
<div class="fragment"><div class="line"><span class="keyword">auto</span> playbackComponent = mAudioEntity-&gt;findComponent&lt;audio::PlaybackComponentInstance&gt;();</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Draw some UI elements to control audio playback</span></div>
<div class="line">ImGui::Begin(<span class="stringliteral">&quot;Audio Playback&quot;</span>);</div>
<div class="line"><span class="keywordflow">if</span> (!playbackComponent-&gt;isPlaying())</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">if</span> (ImGui::Button(<span class="stringliteral">&quot;Play&quot;</span>))</div>
<div class="line">        playbackComponent-&gt;start(0);</div>
<div class="line">}</div>
<div class="line"><span class="keywordflow">else</span> </div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">if</span> (ImGui::Button(<span class="stringliteral">&quot;Stop&quot;</span>))</div>
<div class="line">        playbackComponent-&gt;stop();</div>
<div class="line">}</div>
<div class="line">ImGui::End();</div>
</div><!-- fragment --><p>When we compile and run the app you should see a button. Click on it to start / stop the playback of the audio file.</p>
<div class="image">
<img src="../../content/gs_result.png" alt=""/>
</div>
   <h2><a class="anchor" id="app_render"></a>
Rendering</h2>
<p><code>render</code> is called after <code>update</code>. You use this call to render geometry and UI elements to a window or render target. You have to tell the renderer what you want to render and where to render it to. The button (recorded on <code>update</code>) is rendered when <code>mGuiService-&gt;draw()</code> is called. To learn more about rendering with NAP take a look at our <a class="el" href="../../dd/d9b/rendering.html">render documentation</a>.</p>
<h1><a class="anchor" id="app_package"></a>
Package for Distribution</h1>
<p>To create a distributable package of your application run <code>package.bat</code> (windows) or <code>./package</code> (macOS / Linux). Append <code>--help</code> for additional information. By default the application including Napkin and all assets is packaged for you. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- HTML footer for doxygen 1.8.13-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
<a href="http://www.doxygen.org/index.html"> Generated by doxygen</a></small></address>
</body>
</html>
