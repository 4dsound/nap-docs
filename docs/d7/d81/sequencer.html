<!-- HTML header for doxygen 1.8.13-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<link rel="shortcut icon" href="../../content/icon.ico" type="image/x-icon" />
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>NAP: Sequencer</title>
<link href="https://fonts.googleapis.com/css?family=Montserrat" rel="stylesheet">
<link href="https://fonts.googleapis.com/css?family=Nunito+Sans" rel="stylesheet">
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<script type="text/javascript">
  function inlineSVGfromIFrame () {
    console.log("blaaat")
    var alreadyImported = Boolean(document.querySelectorAll('.dyncontent svg').length)
    if (alreadyImported) return
    var allIFrames = document.querySelectorAll('.dyncontent iframe')
    var allContentBoxes = document.querySelectorAll('.dyncontent .center')
    allIFrames.forEach(function(iFrame, index) {
      var svgElem = iFrame.contentWindow.document.documentElement.cloneNode(true)
      allContentBoxes[index].appendChild(svgElem)
      iFrame.style.display = 'none'
    })
  }
  window.addEventListener("load", inlineSVGfromIFrame, false)
</script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><a href="https://nap.tech"><img alt="Logo" src="../../nap_tech_logo.svg"/></a></td>
  <td id="projectalign" style="padding-left: 0.5em;"><a href="http://www.napframework.com">
   <div id="projectname">NAP
   </div>
  </a>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Sequencer </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><ul>
<li><a class="el" href="../../d7/d81/sequencer.html#introduction">Introduction</a></li>
<li><a class="el" href="../../d7/d81/sequencer.html#player_editor_gui">Player, Editor &amp; EditorGUI</a></li>
<li><a class="el" href="../../d7/d81/sequencer.html#usage">Usage</a><ul>
<li><a class="el" href="../../d7/d81/sequencer.html#using_event_track">Create and Use an Event Track </a></li>
<li><a class="el" href="../../d7/d81/sequencer.html#using_curve_track">Create and Use a Curve Track</a></li>
<li><a class="el" href="../../d7/d81/sequencer.html#using_audio_track">Create and Use an Audio Track</a></li>
<li><a class="el" href="../../d7/d81/sequencer.html#inserting_markers">Inserting markers</a></li>
<li><a class="el" href="../../d7/d81/sequencer.html#renaming_tracks">Renaming tracks</a></li>
</ul>
</li>
<li><a class="el" href="../../d7/d81/sequencer.html#clocks">Clocks</a><ul>
<li><a class="el" href="../../d7/d81/sequencer.html#standard_clock">Standard Clock</a></li>
<li><a class="el" href="../../d7/d81/sequencer.html#independent_clock">Independent Clock</a></li>
<li><a class="el" href="../../d7/d81/sequencer.html#audio_clock">Audio Clock</a></li>
</ul>
</li>
<li><a class="el" href="../../d7/d81/sequencer.html#outputs_and_adapters">Outputs &amp; Adapters</a><ul>
<li><a class="el" href="../../d7/d81/sequencer.html#outputs_and_adapters_examples">Examples</a><ul>
<li><a class="el" href="../../d7/d81/sequencer.html#outputs_and_adapters_examples_event">Event Track</a></li>
<li><a class="el" href="../../d7/d81/sequencer.html#outputs_and_adapters_examples_curve">Curve Track</a></li>
<li><a class="el" href="../../d7/d81/sequencer.html#outputs_and_adapters_examples_audio">Audio Track</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<h1><a class="anchor" id="introduction"></a>
Introduction</h1>
<p>The NAP sequencer can be used to control <code>parameters</code> and <code>trigger events</code> inside a NAP application. Playback can be synchronized to <code>audio</code> or a different <code>external clock</code>. You can animate any amount of parameters while at the same time maintaining flexibility and control over synchronization.</p>
<p>To get a feeling of working with the sequencer check out the <code>sequencer demo</code>!</p>
<p>The sequencer is set up to run independently of the application main render thread. Because of this, the sequencer introduces some concepts that can be hard to understand at first glance. This document serves as a starting point for those who want to work with the sequencer and/or developers that want to add their own features or custom track types to the sequencer.</p>
<p>The following three concepts should be understood when working with the sequencer:</p><ul>
<li>The relationship between the <a class="el" href="../../d7/d81/sequencer.html#player_editor_gui">SequencePlayer, SequenceEditor &amp; SequenceEditorGUI</a></li>
<li>Thread independent playback using the <a class="el" href="../../d7/d81/sequencer.html#clocks">SequencePlayerClock</a></li>
<li><a class="el" href="../../d7/d81/sequencer.html#outputs_and_adapters">Outputs &amp; Adapters</a></li>
</ul>
<div class="image">
<img src="../../content/sequencer-intro.gif" alt="Sequencer Intro" style="width:100%;"/>
</div>
<h1><a class="anchor" id="player_editor_gui"></a>
Player, Editor &amp; GUI</h1>
<p>A fully featured NAP Sequencer is constructed from three different parts:</p>
<ul>
<li>The <a class="el" href="../../dc/d17/classnap_1_1_sequence_player.html">SequencePlayer</a>.</li>
</ul>
<p>Responsible for loading and playing a <a class="el" href="../../d9/da0/classnap_1_1_sequence.html">Sequence</a>.</p>
<ul>
<li>The <a class="el" href="../../d9/dde/classnap_1_1_sequence_editor.html">SequenceEditor</a>.</li>
</ul>
<p>Responsible for editing and saving the <a class="el" href="../../d9/da0/classnap_1_1_sequence.html">sequence</a>, loaded by the player.</p>
<ul>
<li>The <a class="el" href="../../dd/d58/classnap_1_1_sequence_editor_g_u_i.html">SequenceEditorGUI</a>.</li>
</ul>
<p>Responsible for drawing the sequence editor and sequence player using <code>ImGUI</code>.</p>
<p>The following JSON snippet creates a sequence player that uses an <a class="el" href="../../d6/d0f/classnap_1_1_sequence_player_audio_clock.html">audio clock</a> for playback. The sequence editor links to the sequence player. The sequence GUI, in turn, links to the editor: </p><div class="fragment"><div class="line">{</div><div class="line">    &quot;Type&quot;: &quot;nap::SequenceEditor&quot;,</div><div class="line">    &quot;mID&quot;: &quot;SequenceEditor&quot;,</div><div class="line">    &quot;Sequence Player&quot;: &quot;SequencePlayer&quot;</div><div class="line">},</div><div class="line">{</div><div class="line">    &quot;Type&quot;: &quot;nap::SequenceEditorGUI&quot;,</div><div class="line">    &quot;mID&quot;: &quot;SequenceEditorGUI&quot;,</div><div class="line">    &quot;Sequence Editor&quot;: &quot;SequenceEditor&quot;,</div><div class="line">    &quot;Render Window&quot;: &quot;SequencerWindow&quot;,</div><div class="line">    &quot;Draw Full Window&quot;: true</div><div class="line">},</div><div class="line">{</div><div class="line">    &quot;Type&quot;: &quot;nap::SequencePlayer&quot;,</div><div class="line">    &quot;mID&quot;: &quot;SequencePlayer&quot;,</div><div class="line">    &quot;Default Show&quot;: &quot;Default Show.json&quot;,</div><div class="line">    &quot;Outputs&quot;: [],</div><div class="line">    &quot;Clock&quot;: {</div><div class="line">        &quot;Type&quot;: &quot;nap::SequencePlayerAudioClock&quot;,</div><div class="line">        &quot;mID&quot;: &quot;SequencePlayerAudioClock&quot;</div><div class="line">    }</div><div class="line">}</div></div><!-- fragment --><p>The sequence playback logic and data format is completely seperated from the sequence editor and GUI. This means that it is possible to create an application without a window or without the render engine and still use the sequence player (for example when working in headless real-time or near real-time environments) to play back sequences. Subsequently, the sequence editor can be declared without a GUI, meaning you can perform edit calls on a sequence without a GUI attached to it, although this is less common. The sequence editor GUI is defined in a separate module called <code>mod_sequencegui</code>, which depends on <code>mod_napsequence</code>.</p>
<p>To ensure all (live) edits to a sequence are carried out in a thread-safe manner, all edit calls are routed through the sequence editor. The sequence editor creates <a class="el" href="../../d0/dff/classnap_1_1_sequence_controller.html">sequence controllers</a> for each available track type. <a class="el" href="../../d5/d30/classnap_1_1_sequence_track.html">Tracks</a> can be edited by these controllers. Controllers for each available track type are created by the application at run-time during initialization of the sequence editor. All created Sequence Controllers are owned by the sequence editor.</p>
<p>Make sure the edit calls are performed on the same thread that is reading the sequence. For example: The GUI of the sequence editor is drawn on the main (render) thread of the application, so any edit calls to the sequence controller must be executed from the main thread as well.</p>
<h1><a class="anchor" id="usage"></a>
Usage</h1>
<p>In the following example we will create a custom sequence using the <a class="el" href="../../dc/d17/classnap_1_1_sequence_player.html">Sequence Player</a>, <a class="el" href="../../d9/dde/classnap_1_1_sequence_editor.html">Sequence Editor</a> &amp; <a class="el" href="../../dd/d58/classnap_1_1_sequence_editor_g_u_i.html">Sequence GUI</a>. The <a class="el" href="../../d9/da0/classnap_1_1_sequence.html">sequence</a> contains one event track with a couple of events, one curve track that animates a <a class="el" href="../../d3/d14/namespacenap.html#a0f4980e334fbd44811cc38afc58a501e">float parameter</a> and an <a class="el" href="../../d9/d10/classnap_1_1_sequence_track_audio.html">audio track</a> that plays back an <a class="el" href="../../d4/db8/classnap_1_1_sequence_track_segment_audio.html">audio segment</a>. Alternatively you can skip this step and use the <code>sequencer demo</code> instead.</p>
<p>Include the following modules to make sure your project can use all the features of the sequencer:</p>
<ul>
<li>mod_napsequence</li>
<li>mod_napsequencegui</li>
<li>mod_napsequenceaudio</li>
<li>mod_napsequenceaudiogui</li>
</ul>
<p>Open <code>module.json</code> inside the <code>module</code> directory and add them to the <code>RequiredModules</code> field. For more information on how to add modules to your project read the <a class="el" href="../../d1/d66/getting_started.html#getting_started_overview">getting started</a> guide.</p>
<p>Next step is to create a sequence player that has a <code><a class="el" href="../../d3/d0d/classnap_1_1_sequence_player_event_output.html">nap::SequencePlayerEventOutput</a></code>, a <code><a class="el" href="../../d7/d31/classnap_1_1_sequence_player_curve_output.html">nap::SequencePlayerCurveOutput</a></code> and a <code><a class="el" href="../../d4/d49/classnap_1_1_sequence_player_audio_output.html">nap::SequencePlayerAudioOutput</a></code>. You can use <a class="el" href="../../da/d34/napkin.html">Napkin</a> to set this up for you or use the following JSON snippet as an example:</p>
<div class="fragment"><div class="line">{</div><div class="line">    &quot;Type&quot;: &quot;nap::SequencePlayer&quot;,</div><div class="line">    &quot;mID&quot;: &quot;SequencePlayer&quot;,</div><div class="line">    &quot;Default Show&quot;: &quot;Default Show.json&quot;,</div><div class="line">    &quot;Outputs&quot;: [</div><div class="line">        {</div><div class="line">            &quot;Type&quot;: &quot;nap::SequencePlayerEventOutput&quot;,</div><div class="line">            &quot;mID&quot;: &quot;SequencePlayerEventOutput&quot;</div><div class="line">        },</div><div class="line">        {</div><div class="line">            &quot;Type&quot;: &quot;nap::SequencePlayerCurveOutput&quot;,</div><div class="line">            &quot;mID&quot;: &quot;Float Output&quot;,</div><div class="line">            &quot;Parameter&quot;: &quot;Float1&quot;,</div><div class="line">            &quot;Use Main Thread&quot;: true</div><div class="line">        },</div><div class="line">        {</div><div class="line">            &quot;Type&quot;: &quot;nap::SequencePlayerAudioOutput&quot;,</div><div class="line">            &quot;mID&quot;: &quot;SequencePlayerAudioOutput&quot;,</div><div class="line">            &quot;Audio Buffers&quot;: [</div><div class="line">                &quot;AudioFileResource&quot;</div><div class="line">            ],</div><div class="line">            &quot;Manual Routing&quot;: true,</div><div class="line">            &quot;Max Channels&quot;: 2</div><div class="line">        }],</div><div class="line">    &quot;Clock&quot;: {</div><div class="line">        &quot;Type&quot;: &quot;nap::SequencePlayerAudioClock&quot;,</div><div class="line">        &quot;mID&quot;: &quot;SequencePlayerAudioClock&quot;</div><div class="line">    }</div><div class="line">}</div></div><!-- fragment --><h2><a class="anchor" id="using_event_track"></a>
Create and Use an Event Track</h2>
<p>Select the window that draws the sequencer gui. Select <code>Insert Track</code> and then click on <code><a class="el" href="../../de/d9d/classnap_1_1_sequence_track_event.html">nap::SequenceTrackEvent</a></code>. An empty event track will appear. To make sure events on the track get routed to the event output make sure to select the <code><a class="el" href="../../d3/d0d/classnap_1_1_sequence_player_event_output.html">nap::SequencePlayerEventOutput</a></code> from the inspector. To insert an event right-click somewhere in the track. A popup will appear with different types of events. In this example we will insert an event of type <a class="el" href="../../d3/d14/namespacenap.html#a27e46241d7cadda25ede3b9d843a9167">string</a>. An empty string event is inserted on the track. You can move it by dragging the handler of the event or by right clicking it and change the timestamp in the appearing popup. You can also change the value of this event. Because the event holds a string we change the string event to hold a string with the value <code>hello world</code>. When playing back the sequence the event will be dispatched whenever the playback time of the sequencer passes the time at which the event is inserted. To receive the event or get notified attach a listener to the <a class="el" href="../../d3/d0d/classnap_1_1_sequence_player_event_output.html#a1cb781a5a13cb819deeed97b86f549b3">signal</a> of the event output.</p>
<div class="image">
<img src="../../content/sequencer-event.gif" alt="Sequencer Event" style="width:100%;"/>
</div>
<h2><a class="anchor" id="using_curve_track"></a>
Create and Use a Curve Track</h2>
<p>Select the window that draws the sequencer gui. Select <code>Insert Track</code> and then click on <code><a class="el" href="../../d3/d14/namespacenap.html#a88f47d2154ddc3cddec82cc99f5537c4">nap::SequenceTrackCurveFloat</a></code>. An empty curve track will appear. To make sure the drawn curve on the track gets routed to the curve output make sure to select the <code><a class="el" href="../../d7/d31/classnap_1_1_sequence_player_curve_output.html">nap::SequencePlayerCurveOutput</a></code> from the inspector. To insert an event right-click somewhere in the track. A popup will appear asking you to insert a segment. Do so. A curve segment is inserted into the track. You can extend it by dragging the handler of the segment or by right clicking it and change the timestamp in the appearing popup. You can also change the value of this event by dragging the segment value or right click on the segment value. You can also insert point on the curve. Move the mouse cursor somewhere on the curve, right click and select <code>Insert Point</code> in the popup. You can also change the curve type to <code>linear</code> in this popup. When playing back the sequence the parameter, linked to from the curve output, will be set to the current value of the curve, evaluated at the current timestamp of the player.</p>
<div class="image">
<img src="../../content/sequencer-curve.gif" alt="Sequencer Curve" style="width:100%;"/>
</div>
<h2><a class="anchor" id="using_audio_track"></a>
Create and Use an Audio Track</h2>
<p>Select the window that draws the sequencer gui. Select <code>Insert Track</code> and then click on <code><a class="el" href="../../d9/d10/classnap_1_1_sequence_track_audio.html">nap::SequenceTrackAudio</a></code>. An empty audio track will appear. To make sure audio is routed to the audio output select the <code><a class="el" href="../../d4/d49/classnap_1_1_sequence_player_audio_output.html">nap::SequencePlayerAudioOutput</a></code> from the inspector. To insert an audio segment right-click somewhere in the track. A popup will appear with a popup containing all available audio buffer resources. In this example we will insert an audio segment that links to an <code>AudioFileResource</code>, which is an audio file read from disk. To add an audio file resource to your project refer to the <a class="el" href="../../dd/d1e/audio.html#audio_playback">audio</a> documentation. An audio segment will appear on the audio track. When the sequencer is playing the audio in the buffer of the segment will be routed to the audio output. Right clicking on the audio segment will open up a popup that enables you to edit the start time of the segment on the track, the start time within the audio buffer or end time within the audio buffer. This can also be achieved by dragging on the left or right side of the audio segment.</p>
<div class="image">
<img src="../../content/sequencer-audio.gif" alt="Sequencer Audio" style="width:100%;"/>
</div>
<h2><a class="anchor" id="inserting_markers"></a>
Inserting Markers</h2>
<p>The top bar of the gui holds markers. Makers are a visual aid that can be used to tag a specific point of interest in your sequence. Right click somewhere inside the marker bar, a popup will appear, name the marker whatever you like and choose <code>Insert Marker</code>. A marker will appear. You can move the marker by dragging it inside the marker bar or edit it by right clicking on the marker.</p>
<div class="image">
<img src="../../content/sequencer-marker.gif" alt="Sequencer Marker" style="width:100%;"/>
</div>
<h2><a class="anchor" id="renaming_tracks"></a>
Renaming Tracks</h2>
<p>You can rename tracks by clicking on the track title in the inspector.</p>
<h1><a class="anchor" id="clocks"></a>
Clocks</h1>
<p>You have complete control over synchronisation. The way the sequencer updates is by using a <code>clock</code>. You can decide what type of clock is used. It is possible to write your own clock when you need synchronisation with another already running process. For now, three types of clocks are already implemented in NAP.</p>
<h2><a class="anchor" id="standard_clock"></a>
Standard Clock</h2>
<p>The <a class="el" href="../../d0/dd1/classnap_1_1_sequence_player_standard_clock.html">standard clock</a> is updated on the main thread by the <a class="el" href="../../df/dbe/classnap_1_1_sequence_service.html">sequence service</a>. This is sufficient for most use cases. The following example creates a sequence player that uses a standard clock for playback.</p>
<div class="fragment"><div class="line">{</div><div class="line">    &quot;Type&quot;: &quot;nap::SequencePlayer&quot;,</div><div class="line">    &quot;mID&quot;: &quot;SequencePlayer&quot;,</div><div class="line">    &quot;Default Show&quot;: &quot;Default Show.json&quot;,</div><div class="line">    &quot;Outputs&quot;: [],</div><div class="line">    &quot;Clock&quot;: {</div><div class="line">        &quot;Type&quot;: &quot;nap::SequencePlayerStandardClock&quot;,</div><div class="line">        &quot;mID&quot;: &quot;SequencePlayerStandardClock&quot;</div><div class="line">    }</div><div class="line">}</div></div><!-- fragment --><h2><a class="anchor" id="independent_clock"></a>
Independent Clock</h2>
<p>The <a class="el" href="../../de/df4/classnap_1_1_sequence_player_independent_clock.html">independent clock</a> launches its own thread. The thread update cycle is dependent on the given frequency. Frequency is set in update calls per second (Hz). The following example creates a sequence player that uses an independent clock for playback. The independent clock will update the sequence player 1000 times per second (1000 Hz).</p>
<div class="fragment"><div class="line">{</div><div class="line">    &quot;Type&quot;: &quot;nap::SequencePlayer&quot;,</div><div class="line">    &quot;mID&quot;: &quot;SequencePlayer&quot;,</div><div class="line">    &quot;Default Show&quot;: &quot;Default Show.json&quot;,</div><div class="line">    &quot;Outputs&quot;: [],</div><div class="line">    &quot;Clock&quot;: {</div><div class="line">        &quot;Type&quot;: &quot;nap::SequencePlayerIndependentClock&quot;,</div><div class="line">        &quot;mID&quot;: &quot;SequencePlayerIndependentClock&quot;,</div><div class="line">        &quot;Frequency&quot; : 1000</div><div class="line">    }</div><div class="line">}</div></div><!-- fragment --><h2><a class="anchor" id="audio_clock"></a>
Audio Clock</h2>
<p>The update cycle is called on the audio thread of NAPs audio engine. Amount of update calls is dependent on audio buffer size and sample rate. For example, a buffer size of 1024 and sample rate of 44100 samples means 44100 / 1024 = 43.06640625 calls per second. To increase the number of update calls per second make the buffer size smaller. The <a class="el" href="../../d6/d0f/classnap_1_1_sequence_player_audio_clock.html">audio clock</a> must be used when using an <a class="el" href="../../d9/d10/classnap_1_1_sequence_track_audio.html">audio track</a> type in the sequencer.</p>
<p>To change the buffer size and/or samplerate used by the <a class="el" href="../../df/d42/classnap_1_1audio_1_1_audio_service.html">audio service</a>, see <a class="el" href="../../de/d2e/classnap_1_1audio_1_1_audio_service_configuration.html">audio service configuration</a>. The following example creates a sequence player that uses an audio clock for playback.</p>
<div class="fragment"><div class="line">{</div><div class="line">    &quot;Type&quot;: &quot;nap::SequencePlayer&quot;,</div><div class="line">    &quot;mID&quot;: &quot;SequencePlayer&quot;,</div><div class="line">    &quot;Default Show&quot;: &quot;Default Show.json&quot;,</div><div class="line">    &quot;Outputs&quot;: [],</div><div class="line">    &quot;Clock&quot;: {</div><div class="line">        &quot;Type&quot;: &quot;nap::SequencePlayerAudioClock&quot;,</div><div class="line">        &quot;mID&quot;: &quot;SequencePlayerAudioClock&quot;</div><div class="line">    }</div><div class="line">}</div></div><!-- fragment --><h1><a class="anchor" id="outputs_and_adapters"></a>
Outputs &amp; Adapters</h1>
<p>When the sequence player starts playback it will create an <a class="el" href="../../d7/d45/classnap_1_1_sequence_player_adapter.html">adapter</a> for each track in the sequence. The adapter evaluates the track on update (<a class="el" href="../../d7/d45/classnap_1_1_sequence_player_adapter.html#ae194595d65034029fea04a5d33526ce0">tick</a>) and translates the data into information to output. An assigned <a class="el" href="../../de/dac/classnap_1_1_sequence_player_output.html">sequence player ouput</a> receives this information from the adapter and forwards it to your application. Every output is a resource, embedded within the sequence player, that can be linked to within your application. Adapters are created and managed by the <a class="el" href="../../dc/d17/classnap_1_1_sequence_player.html">sequence player</a>.</p>
<p>For example: Imagine a <a class="el" href="../../d3/d0d/classnap_1_1_sequence_player_event_output.html">SequencePlayerEventOutput</a> with the ID <code>ShowControlOutput</code> that is added to your sequence player. The <a class="el" href="../../d5/d30/classnap_1_1_sequence_track.html#a11b9d2dcc0fe675c1a83b82f09f61a85">mOutputID</a> property of the event track is assigned to <code>ShowControlOutput</code>. When the marker hits the <code>StartVideoPlayback</code> event on the track during playback, the sequence player will tell the output (using an adapter) to dispatch the <code>StartVideoPlayback</code> message on the main thread. A handler, somewhere in your application, is interested in this event and starts video playback when <code>StartVideoPlayback</code> is received. A good rule of thumb here is that outputs should always be safe to link to from other parts of the application and/or from the applications main thread, while adapters are only created, used and owned by the sequence player.</p>
<p>The following example creates a sequence player with two outputs. An <a class="el" href="../../d3/d0d/classnap_1_1_sequence_player_event_output.html">event output</a> (discussed above) and a <a class="el" href="../../d7/d31/classnap_1_1_sequence_player_curve_output.html">curve output</a>.</p>
<ul>
<li>The event output dispatches a message when an event occurs on an <a class="el" href="../../de/d9d/classnap_1_1_sequence_track_event.html">event track</a>.</li>
<li>The curve output evaluates the shape of a curve on a <a class="el" href="../../d6/de8/classnap_1_1_base_sequence_track_curve.html">curve track</a> and can be linked to a <a class="el" href="../../d5/de5/classnap_1_1_parameter.html">parameter</a></li>
</ul>
<p>The <code>Use Main Thread</code> property on a curve output controls if the parameter is updated on the main thread or the thread that updates the sequence player (controlled by the clock). Sequence track events are are always dispatched from the main thread.</p>
<div class="fragment"><div class="line">{</div><div class="line">    &quot;Type&quot;: &quot;nap::SequencePlayer&quot;,</div><div class="line">    &quot;mID&quot;: &quot;SequencePlayer&quot;,</div><div class="line">    &quot;Default Show&quot;: &quot;Default Show.json&quot;,</div><div class="line">    &quot;Outputs&quot;: [</div><div class="line">        {</div><div class="line">            &quot;Type&quot;: &quot;nap::SequencePlayerEventOutput&quot;,</div><div class="line">            &quot;mID&quot;: &quot;ShowControlOutput&quot;</div><div class="line">        },</div><div class="line">        {</div><div class="line">            &quot;Type&quot;: &quot;nap::SequencePlayerCurveOutput&quot;,</div><div class="line">            &quot;mID&quot;: &quot;Float Output&quot;,</div><div class="line">            &quot;Parameter&quot;: &quot;Float1&quot;,</div><div class="line">            &quot;Use Main Thread&quot;: true</div><div class="line">        }]</div><div class="line">    &quot;Clock&quot;: {</div><div class="line">        &quot;Type&quot;: &quot;nap::SequencePlayerAudioClock&quot;,</div><div class="line">        &quot;mID&quot;: &quot;SequencePlayerAudioClock&quot;</div><div class="line">    }</div><div class="line">}</div></div><!-- fragment --> <h2><a class="anchor" id="outputs_and_adapters_examples"></a>
Flow Examples</h2>
<p>The images belows explain the relation between the sequence player, sequence adapter &amp; sequence player output. When the sequence player receives a tick from the clock it asks all created adapters to evaluate their assigned tracks.</p>
<h3><a class="anchor" id="outputs_and_adapters_examples_event"></a>
Event Track</h3>
<p>If an event needs to be dispatched the adapter moves the event to it's assigned output. The output update method gets called on the main thread from the sequence service. On update all queued events will be consumed and dispatched using a <a class="el" href="../../de/d80/classnap_1_1_signal.html">signal</a> so any listeners will get notified.</p>
<div class="image">
<img src="../../content/sequencer-event.png" alt="Sequencer Event" style="width:100%;"/>
</div>
<h3><a class="anchor" id="outputs_and_adapters_examples_curve"></a>
Curve Track</h3>
<p>When evaluating a curve track the adapter evaluates the curve track and extracts the value. It then passes the value to it's assigned output. The output then updates the linked parameter either directly when the <code>mUseMainThread</code> property is set to false or on the main thread if <code>mUseMainThread</code> is set to true. If <code>mUseMainThread</code> is set to true, the will be updated on the next update coming from the service.</p>
<div class="image">
<img src="../../content/sequencer-curve.png" alt="Sequencer Curve" style="width:100%;"/>
</div>
<h3><a class="anchor" id="outputs_and_adapters_examples_audio"></a>
Audio Track</h3>
<p>When evaluating an <a class="el" href="../../d9/d10/classnap_1_1_sequence_track_audio.html">audio track</a> the <a class="el" href="../../d2/d2e/classnap_1_1_sequence_player_audio_adapter.html">audio adapter</a> figures out the player's position in samples of the buffer that is linked to by the <a class="el" href="../../d4/db8/classnap_1_1_sequence_track_segment_audio.html">audio segment</a> on the audio track, together with the playback speed (pitch). The speed &amp; position is then set on the <a class="el" href="../../d4/d49/classnap_1_1_sequence_player_audio_output.html">sequence audio output</a> which in turns plays or stops up the correct <a class="el" href="../../da/d0f/classnap_1_1audio_1_1_multi_sample_buffer_player_node.html">audio node</a>, created for each <a class="el" href="../../df/dac/classnap_1_1audio_1_1_audio_buffer_resource.html">audio buffer</a>.</p>
<p>The <a class="el" href="../../d2/d14/classnap_1_1audio_1_1_sequence_player_audio_output_component.html">sequence player audio output component</a> by default routes its audio to the AudioService by creating its own <a class="el" href="../../d2/da1/classnap_1_1audio_1_1_output_node.html">output nodes</a>. To disable this and route the audio output to your own processing chain you can set its <code>Manual Routing</code> property to true and use <a class="el" href="../../d4/d49/classnap_1_1_sequence_player_audio_output.html#a4a90ab66992877533342a8b20f379c2f">getOutputForChannel</a> or the sequence player audio output componewnt.</p>
<div class="image">
<img src="../../content/sequencer-audio.png" alt="Sequencer Audio" style="width:100%;"/>
</div>
 </div></div><!-- contents -->
<!-- HTML footer for doxygen 1.8.13-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
<a href="http://www.doxygen.org/index.html"> Generated by doxygen</a></small></address>
</body>
</html>
